{"ast":null,"code":"import React,{useState,useEffect}from'react';import ReactDOM from'react-dom/client';import axios from'axios';import'./index.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[listings,setListings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetchListings();},[]);const fetchListings=async()=>{try{console.log(\"üöÄ SOKO: Initiating connection to backend...\");// TRICK 1: Direct path to Netlify Functions\n// This bypasses potential proxy issues in Codespaces\nconst res=await axios.get('/.netlify/functions/api/listings');console.log(\"‚úÖ SOKO: Data received:\",res.data);if(Array.isArray(res.data)&&res.data.length>0){setListings(res.data);}else if(Array.isArray(res.data)&&res.data.length===0){// Empty list is not an error, just empty\nsetListings([]);}else{throw new Error(\"Invalid data format received from backend\");}}catch(err){console.error(\"‚ùå SOKO: Fetch failed:\",err);setError(err.message||\"Unknown error\");}finally{setLoading(false);}};// TRICK 2: The \"Emergency\" Button (Your Safety Net)\nconst loadDemoData=()=>{console.log(\"‚ö†Ô∏è Activating Demo Mode\");setListings([{_id:'1',name:'Mama Solar (Nairobi)',kwh:120,price:15,type:'SOLAR'},{_id:'2',name:'City Grid Share',kwh:500,price:22,type:'GRID'},{_id:'3',name:'Sunny Side Up',kwh:75,price:12,type:'SOLAR'}]);setError(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26A1 SOKO\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Peer-to-Peer Energy\"})]}),/*#__PURE__*/_jsxs(\"main\",{children:[loading&&/*#__PURE__*/_jsx(\"p\",{className:\"status\",children:\"\\uD83D\\uDCE1 Connecting to Energy Grid...\"}),error&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#ff6b6b',textAlign:'center',marginBottom:'30px',border:'1px solid #ff6b6b',padding:'20px',borderRadius:'8px'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u26A0\\uFE0F Connection Issue:\"}),\" \",error]}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'0.9rem',color:'#ccc'},children:\"The backend might be sleeping. Use Demo Mode for presentation.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:loadDemoData,style:{backgroundColor:'#D4AF37',color:'#000'},children:\"ACTIVATE DEMO MODE\"})]}),!loading&&!error&&listings.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginTop:'40px'},children:[/*#__PURE__*/_jsx(\"p\",{children:\"No energy listings found nearby.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:loadDemoData,style:{backgroundColor:'#D4AF37',color:'#000'},children:\"SHOW SAMPLE DATA\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:listings.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon\",children:item.type==='SOLAR'?'‚òÄÔ∏è':'üîã'}),/*#__PURE__*/_jsx(\"h3\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[item.kwh,\" kWh available\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-tag\",children:[item.price,\" KES / unit\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>alert(\"Purchasing \".concat(item.kwh,\" kWh from \").concat(item.name)),children:\"Buy Now\"})]},item._id))})]})]});};const root=ReactDOM.createRoot(document.getElementById('root'));root.render(/*#__PURE__*/_jsx(App,{}));","map":{"version":3,"names":["React","useState","useEffect","ReactDOM","axios","jsx","_jsx","jsxs","_jsxs","App","listings","setListings","loading","setLoading","error","setError","fetchListings","console","log","res","get","data","Array","isArray","length","Error","err","message","loadDemoData","_id","name","kwh","price","type","className","children","style","color","textAlign","marginBottom","border","padding","borderRadius","fontSize","onClick","backgroundColor","marginTop","map","item","alert","concat","root","createRoot","document","getElementById","render"],"sources":["/workspaces/Soko-app/client/src/index.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport axios from 'axios';\nimport './index.css';\n\nconst App = () => {\n  const [listings, setListings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchListings();\n  }, []);\n\n  const fetchListings = async () => {\n    try {\n      console.log(\"üöÄ SOKO: Initiating connection to backend...\");\n      \n      // TRICK 1: Direct path to Netlify Functions\n      // This bypasses potential proxy issues in Codespaces\n      const res = await axios.get('/.netlify/functions/api/listings'); \n      \n      console.log(\"‚úÖ SOKO: Data received:\", res.data);\n      \n      if (Array.isArray(res.data) && res.data.length > 0) {\n        setListings(res.data);\n      } else if (Array.isArray(res.data) && res.data.length === 0) {\n        // Empty list is not an error, just empty\n        setListings([]);\n      } else {\n        throw new Error(\"Invalid data format received from backend\");\n      }\n    } catch (err) {\n      console.error(\"‚ùå SOKO: Fetch failed:\", err);\n      setError(err.message || \"Unknown error\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // TRICK 2: The \"Emergency\" Button (Your Safety Net)\n  const loadDemoData = () => {\n    console.log(\"‚ö†Ô∏è Activating Demo Mode\");\n    setListings([\n      { _id: '1', name: 'Mama Solar (Nairobi)', kwh: 120, price: 15, type: 'SOLAR' },\n      { _id: '2', name: 'City Grid Share', kwh: 500, price: 22, type: 'GRID' },\n      { _id: '3', name: 'Sunny Side Up', kwh: 75, price: 12, type: 'SOLAR' }\n    ]);\n    setError(null);\n  };\n\n  return (\n    <div className=\"app-container\">\n      <header>\n        <h1>‚ö° SOKO</h1>\n        <p>Peer-to-Peer Energy</p>\n      </header>\n\n      <main>\n        {loading && <p className=\"status\">üì° Connecting to Energy Grid...</p>}\n        \n        {/* Error State: Shows the red error and the Safety Button */}\n        {error && (\n          <div style={{color: '#ff6b6b', textAlign: 'center', marginBottom: '30px', border: '1px solid #ff6b6b', padding: '20px', borderRadius: '8px'}}>\n            <p><strong>‚ö†Ô∏è Connection Issue:</strong> {error}</p>\n            <p style={{fontSize: '0.9rem', color: '#ccc'}}>The backend might be sleeping. Use Demo Mode for presentation.</p>\n            <button onClick={loadDemoData} style={{backgroundColor: '#D4AF37', color: '#000'}}>\n              ACTIVATE DEMO MODE\n            </button>\n          </div>\n        )}\n\n        {/* Empty State: Shows if backend connects but has no data */}\n        {!loading && !error && listings.length === 0 && (\n           <div style={{textAlign: 'center', marginTop: '40px'}}>\n             <p>No energy listings found nearby.</p>\n             <button onClick={loadDemoData} style={{backgroundColor: '#D4AF37', color: '#000'}}>\n              SHOW SAMPLE DATA\n            </button>\n           </div>\n        )}\n\n        {/* Success State: The Grid */}\n        <div className=\"grid\">\n          {listings.map((item) => (\n            <div key={item._id} className=\"card\">\n              <div className=\"icon\">{item.type === 'SOLAR' ? '‚òÄÔ∏è' : 'üîã'}</div>\n              <h3>{item.name}</h3>\n              <p>{item.kwh} kWh available</p>\n              <div className=\"price-tag\">{item.price} KES / unit</div>\n              <button onClick={() => alert(`Purchasing ${item.kwh} kWh from ${item.name}`)}>\n                Buy Now\n              </button>\n            </div>\n          ))}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(<App />);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}