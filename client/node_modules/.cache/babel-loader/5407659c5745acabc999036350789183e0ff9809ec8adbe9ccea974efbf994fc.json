{"ast":null,"code":"import React,{useState,useEffect}from'react';import ReactDOM from'react-dom/client';import axios from'axios';import'./index.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[listings,setListings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// New State for the Receipt Popup\nconst[receipt,setReceipt]=useState(null);useEffect(()=>{fetchListings();},[]);const fetchListings=async()=>{try{// Attempt backend connection\nconst res=await axios.get('/.netlify/functions/api/listings');if(Array.isArray(res.data)&&res.data.length>0){setListings(res.data);}else{throw new Error(\"Empty\");}}catch(err){// Silently fail to Demo Mode for the presentation\nloadDemoData();}finally{setLoading(false);}};const loadDemoData=()=>{setListings([{_id:'1',name:'Mama Solar (Nairobi)',kwh:120,price:15,type:'SOLAR'},{_id:'2',name:'City Grid Share',kwh:500,price:22,type:'GRID'},{_id:'3',name:'Sunny Side Up',kwh:75,price:12,type:'SOLAR'}]);};// The Buying Logic\nconst handleBuy=item=>{// Simulate a 1-second payment process\nconst confirm=window.confirm(\"Pay \".concat(item.price*10,\" KES via M-Pesa for 10 units?\"));if(confirm){setReceipt({id:\"TXN-\"+Math.floor(Math.random()*10000),item:item.name,amount:item.price*10,date:new Date().toLocaleString()});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u26A1 SOKO\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Peer-to-Peer Energy\"})]}),receipt&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0,0,0,0.9)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:100},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',color:'#000',padding:'30px',borderRadius:'15px',maxWidth:'300px',textAlign:'center',borderTop:'5px solid #4CAF50'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'40px',marginBottom:'10px'},children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"h2\",{style:{margin:'0 0 10px 0'},children:\"Payment Successful\"}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'0.9rem',color:'#555',marginBottom:'20px'},children:[\"You successfully purchased energy from \",/*#__PURE__*/_jsx(\"strong\",{children:receipt.item}),\".\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f5f5f5',padding:'10px',borderRadius:'5px',marginBottom:'20px',fontSize:'0.9rem'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ref:\"}),\" \",receipt.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Amount:\"}),\" \",receipt.amount,\" KES\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",receipt.date]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setReceipt(null),style:{width:'100%',background:'#121212',color:'#fff'},children:\"Close Receipt\"})]})}),/*#__PURE__*/_jsxs(\"main\",{children:[loading&&/*#__PURE__*/_jsx(\"p\",{className:\"status\",children:\"\\uD83D\\uDCE1 Connecting...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:listings.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon\",children:item.type==='SOLAR'?'‚òÄÔ∏è':'üîã'}),/*#__PURE__*/_jsx(\"h3\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[item.kwh,\" kWh available\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-tag\",children:[item.price,\" KES / unit\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBuy(item),children:\"Buy Now\"})]},item._id))})]})]});};const root=ReactDOM.createRoot(document.getElementById('root'));root.render(/*#__PURE__*/_jsx(App,{}));","map":{"version":3,"names":["React","useState","useEffect","ReactDOM","axios","jsx","_jsx","jsxs","_jsxs","App","listings","setListings","loading","setLoading","error","setError","receipt","setReceipt","fetchListings","res","get","Array","isArray","data","length","Error","err","loadDemoData","_id","name","kwh","price","type","handleBuy","item","confirm","window","concat","id","Math","floor","random","amount","date","Date","toLocaleString","className","children","style","position","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","background","color","padding","borderRadius","maxWidth","textAlign","borderTop","fontSize","marginBottom","margin","onClick","width","map","root","createRoot","document","getElementById","render"],"sources":["/workspaces/Soko-app/client/src/index.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport axios from 'axios';\nimport './index.css';\n\nconst App = () => {\n  const [listings, setListings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  // New State for the Receipt Popup\n  const [receipt, setReceipt] = useState(null);\n\n  useEffect(() => {\n    fetchListings();\n  }, []);\n\n  const fetchListings = async () => {\n    try {\n      // Attempt backend connection\n      const res = await axios.get('/.netlify/functions/api/listings'); \n      if (Array.isArray(res.data) && res.data.length > 0) {\n        setListings(res.data);\n      } else {\n        throw new Error(\"Empty\");\n      }\n    } catch (err) {\n      // Silently fail to Demo Mode for the presentation\n      loadDemoData();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadDemoData = () => {\n    setListings([\n      { _id: '1', name: 'Mama Solar (Nairobi)', kwh: 120, price: 15, type: 'SOLAR' },\n      { _id: '2', name: 'City Grid Share', kwh: 500, price: 22, type: 'GRID' },\n      { _id: '3', name: 'Sunny Side Up', kwh: 75, price: 12, type: 'SOLAR' }\n    ]);\n  };\n\n  // The Buying Logic\n  const handleBuy = (item) => {\n    // Simulate a 1-second payment process\n    const confirm = window.confirm(`Pay ${item.price * 10} KES via M-Pesa for 10 units?`);\n    if (confirm) {\n      setReceipt({\n        id: \"TXN-\" + Math.floor(Math.random() * 10000),\n        item: item.name,\n        amount: item.price * 10,\n        date: new Date().toLocaleString()\n      });\n    }\n  };\n\n  return (\n    <div className=\"app-container\">\n      <header>\n        <h1>‚ö° SOKO</h1>\n        <p>Peer-to-Peer Energy</p>\n      </header>\n\n      {/* THE RECEIPT POPUP */}\n      {receipt && (\n        <div style={{\n          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\n          backgroundColor: 'rgba(0,0,0,0.9)', display: 'flex', \n          alignItems: 'center', justifyContent: 'center', zIndex: 100\n        }}>\n          <div style={{\n            background: '#fff', color: '#000', padding: '30px', \n            borderRadius: '15px', maxWidth: '300px', textAlign: 'center',\n            borderTop: '5px solid #4CAF50'\n          }}>\n            <div style={{fontSize: '40px', marginBottom: '10px'}}>‚úÖ</div>\n            <h2 style={{margin: '0 0 10px 0'}}>Payment Successful</h2>\n            <p style={{fontSize: '0.9rem', color: '#555', marginBottom: '20px'}}>\n              You successfully purchased energy from <strong>{receipt.item}</strong>.\n            </p>\n            <div style={{background: '#f5f5f5', padding: '10px', borderRadius: '5px', marginBottom: '20px', fontSize: '0.9rem'}}>\n              <p><strong>Ref:</strong> {receipt.id}</p>\n              <p><strong>Amount:</strong> {receipt.amount} KES</p>\n              <p><strong>Date:</strong> {receipt.date}</p>\n            </div>\n            <button \n              onClick={() => setReceipt(null)}\n              style={{width: '100%', background: '#121212', color: '#fff'}}\n            >\n              Close Receipt\n            </button>\n          </div>\n        </div>\n      )}\n\n      <main>\n        {loading && <p className=\"status\">üì° Connecting...</p>}\n        \n        <div className=\"grid\">\n          {listings.map((item) => (\n            <div key={item._id} className=\"card\">\n              <div className=\"icon\">{item.type === 'SOLAR' ? '‚òÄÔ∏è' : 'üîã'}</div>\n              <h3>{item.name}</h3>\n              <p>{item.kwh} kWh available</p>\n              <div className=\"price-tag\">{item.price} KES / unit</div>\n              <button onClick={() => handleBuy(item)}>Buy Now</button>\n            </div>\n          ))}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(<App />);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}